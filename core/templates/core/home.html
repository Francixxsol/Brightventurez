{% extends "core/base.html" %}
{% block content %}

<!-- Hero Section -->
<section class="card hero">
  <h1>Cheaper Data. Faster VTU. Data Transformed into Cash.</h1>
  <p class="sub">Buy data and airtime, convert airtime to cash, or sell your data for money. Your digital life empowered.</p>
  <p class="sub humor">
    "From bytes to bucks, from airtime to vibes.<br>
    Bright Venturez fuels your digital soul with every click, every tap, every sigh of the network."
  </p>
  <div class="row gap">
    <a class="btn primary" href="{% url 'core:register' %}">Get Started</a>
    <a class="btn ghost" href="{% url 'core:buy_data' %}">Buy Data</a>
  </div>
</section>

<!-- User Reviews Section -->
<section class="card">
  <h3>User Reviews</h3>
  <div class="carousel" id="reviewsCarousel">
    {% for r in reviews %}
      <div class="review-card">
        <div class="review-name">{{ r.name }}</div>
        <div class="review-text">{{ r.text }}</div>
      </div>
    {% endfor %}
  </div>
</section>

<!-- Plans Section -->
<section class="card">
  <h3>Explore Our Plans</h3>
  <p class="sub">Select a network and plan type to see exactly what your data will look like before it dances into your phone.</p>

  <!-- Filters -->
  <div class="filters">
    <label>Network</label>
    <select id="networkFilter">
      <option value="">-- Select Network --</option>
      {% for network in networks %}
        <option value="{{ network.name|upper }}">{{ network.name|title }}</option>
      {% endfor %}
    </select>

    <label>Plan Type</label>
    <select id="planTypeFilter">
      <option value="">-- Select Plan Type --</option>
      <option value="sme">SME</option>
      <option value="cg">Corporate</option>
      <option value="gifting">Gifting</option>
      <option value="cglite">CGlite</option>
      <option value="special">Special Plan</option>
      <option value="datacard">Data Card</option>
    </select>
  </div>

  <!-- Plans Table -->
  <div class="plans-container" id="plansContainer">
    {% for network in networks %}
      <h4>{{ network.name|title }} Plans</h4>
      <table class="plans-table">
        <thead>
          <tr>
            <th>Plan Type</th>
            <th>Plan Name</th>
            <th>Duration</th>
            <th>Epin Code</th>
            <th>Our Price (₦)</th>
          </tr>
        </thead>
        <tbody>
          {% for plan in network.plans %}
          <tr class="plan-row" data-network="{{ network.name|upper }}" data-plan-type="{{ plan.plan_type|lower }}">
            <td>{{ plan.plan_type|title }}</td>
            <td>{{ plan.plan_name }}</td>
            <td>{{ plan.duration }}</td>
            <td>{{ plan.epin }}</td>
            <td>₦ {{ plan.my_price|floatformat:2 }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
  </div>
</section>

<!-- JavaScript for dynamic filtering -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const networkSelect = document.getElementById("networkFilter");
  const planTypeSelect = document.getElementById("planTypeFilter");
  const planRows = document.querySelectorAll(".plan-row");

  function filterPlans() {
    const selectedNetwork = networkSelect.value.trim().toLowerCase();
    const selectedPlanType = planTypeSelect.value.trim().toLowerCase();

    planRows.forEach(row => {
      const rowNetwork = row.dataset.network.trim().toLowerCase();
      const rowPlanType = row.dataset.planType.trim().toLowerCase();

      if ((selectedNetwork === "" || rowNetwork === selectedNetwork) &&
          (selectedPlanType === "" || rowPlanType === selectedPlanType)) {
        row.style.display = "";
      } else {
        row.style.display = "none";
      }
    });
  }

  networkSelect.addEventListener("change", filterPlans);
  planTypeSelect.addEventListener("change", filterPlans);
});
</script>

<style>
.card {
  max-width: 900px;
  margin: 30px auto;
  padding: 20px;
  background: #1a1b3a;
  color: #fff;
  border-radius: 16px;
  box-shadow: 0 0 25px rgba(75,108,183,0.3);
}
.card h2, .card h3, .card h4 { margin-bottom: 15px; }
.filters { display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; }
.filters label { display: block; margin-top: 10px; font-size: 14px; }
.filters select { padding: 8px 12px; border-radius: 8px; border: none; }
.plans-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
.plans-table th, .plans-table td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.2); }
.plans-table th { background: rgba(255,255,255,0.05); }
</style>

{% endblock %}
